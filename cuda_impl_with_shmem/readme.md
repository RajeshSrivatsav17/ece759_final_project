Smoke simulation with shared memory
